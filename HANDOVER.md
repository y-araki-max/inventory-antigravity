# プロジェクト最終引き継ぎ書 (Strict v13.5)

**重要**: 本ドキュメントは 2026年2月18日時点の最終決定版（v13.5）です。
`TypeError` を完全に解消し、計算ロジックを「完全インライン化」しました。

## 1. 唯一の正解ルール (Single Source of Truth)

### 計算ロジックの自己完結化 (Strict v13.5)
- **外部依存の排除**: `InventoryTable.jsx` 内で、Reactのレンダリングプロセスのみを使って計算しています。外部関数（Formatter等）はループ内で一切呼び出しません。
- **トランザクションフィルタ**: `useInventory` から取得した `transactions` を、ループ内で「商品ID」と「日付文字列」で直接照合します。
- **パフォーマンス**: 商品IDによる事前フィルタリング (`productTxs`) を導入し、ループ回数を削減しました。
- **堅牢性**: 配列チェックや数値型チェックを厳密に行い、データ不整合時でも「0」を表示してクラッシュを防ぎます。

### BOSS ID (黒三角)
- **インライン実装**: CSSによる黒い三角形 (`border-t-black`) の描画と、ツールチップの表示ロジックも全てインラインで記述されています。
- **表示条件**: 当日出庫数が10以上の場合にのみ表示されます。

## 2. 運用ルール
- 画面が白くなる、エラーが出るなどの現象は解決済みです。
- 在庫推移は前月からの繰越在庫をベースに、日々の増減が正確に反映されます。

----
This document serves as the absolute reference for the project (v13.5).
